<!DOCTYPE html>
<!--[if IE 7]>
<html class="ie ie7" lang="en-US">
<![endif]-->
<!--[if IE 8]>
<html class="ie ie8" lang="en-US">
<![endif]-->
<!--[if !(IE 7) & !(IE 8)]><!-->
<html lang="en-US">
<!--<![endif]-->
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width">
	<title>Geek | Home of noocyte | Page 2</title>
	<link rel="profile" href="http://gmpg.org/xfn/11">
	<link rel="pingback" href="http://blog.noocyte.net/xmlrpc.php">
	<!--[if lt IE 9]>
	<script src="http://blog.noocyte.net/wp-content/themes/twentythirteen/js/html5.js"></script>
	<![endif]-->
	<link rel="alternate" type="application/rss+xml" title="Home of noocyte &raquo; Feed" href="../../../../../feed/index.html" />
<link rel="alternate" type="application/rss+xml" title="Home of noocyte &raquo; Comments Feed" href="../../../../../comments/feed/index.html" />
<link rel="alternate" type="application/rss+xml" title="Home of noocyte &raquo; Geek Category Feed" href="../../feed/index.html" />
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"http:\/\/s.w.org\/images\/core\/emoji\/72x72\/","ext":".png","source":{"concatemoji":"http:\/\/blog.noocyte.net\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.2.2"}};
			!function(a,b,c){function d(a){var c=b.createElement("canvas"),d=c.getContext&&c.getContext("2d");return d&&d.fillText?(d.textBaseline="top",d.font="600 32px Arial","flag"===a?(d.fillText(String.fromCharCode(55356,56812,55356,56807),0,0),c.toDataURL().length>3e3):(d.fillText(String.fromCharCode(55357,56835),0,0),0!==d.getImageData(16,16,1,1).data[0])):!1}function e(a){var c=b.createElement("script");c.src=a,c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g;c.supports={simple:d("simple"),flag:d("flag")},c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.simple&&c.supports.flag||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel='stylesheet' id='twentythirteen-fonts-css'  href='http://fonts.googleapis.com/css?family=Source+Sans+Pro%3A300%2C400%2C700%2C300italic%2C400italic%2C700italic%7CBitter%3A400%2C700&amp;subset=latin%2Clatin-ext' type='text/css' media='all' />
<link rel='stylesheet' id='genericons-css'  href='../../../../../wp-content/themes/twentythirteen/genericons/genericons.css@ver=3.03.css' type='text/css' media='all' />
<link rel='stylesheet' id='twentythirteen-style-css'  href='../../../../../wp-content/themes/twentythirteen/style.css@ver=2013-07-18.css' type='text/css' media='all' />
<!--[if lt IE 9]>
<link rel='stylesheet' id='twentythirteen-ie-css'  href='http://blog.noocyte.net/wp-content/themes/twentythirteen/css/ie.css?ver=2013-07-18' type='text/css' media='all' />
<![endif]-->
<script type='text/javascript' src='../../../../../wp-includes/js/jquery/jquery.js@ver=1.11.2'></script>
<script type='text/javascript' src='../../../../../wp-includes/js/jquery/jquery-migrate.min.js@ver=1.2.1'></script>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="../../../../../xmlrpc.php@rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="../../../../../wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 4.2.2" />
<!-- Copy this script into your html file to enable Application Insights -->
<script type="text/javascript">
    window.appInsights={queue:[],applicationInsightsId:null,accountId:null,appUserId:null,configUrl:null,start:function(n){function u(n,t){n[t]=function(){var i=arguments;n.queue.push(function(){n[t].apply(n,i)})}}function f(n){var t=document.createElement("script");return t.type="text/javascript",t.src=n,t.async=!0,t}function r(){i.appendChild(f("//az416426.vo.msecnd.net/scripts/ai.0.js"))}var i,t;this.applicationInsightsId=n;u(this,"logEvent");u(this,"logPageView");i=document.getElementsByTagName("script")[0].parentNode;this.configUrl===null?r():(t=f(this.configUrl),t.onload=r,t.onerror=r,i.appendChild(t));this.start=function(){}}};

    appInsights.start("5e97fe9e-52e7-4eab-8869-5501ea0cdbe9");
    appInsights.logPageView();
</script>	<style type="text/css">.recentcomments a{display:inline !important;padding:0 !important;margin:0 !important;}</style>
	<style type="text/css" id="twentythirteen-header-css">
			.site-header {
			background: url(../../../../../wp-content/themes/twentythirteen/images/headers/circle.png) no-repeat scroll top;
			background-size: 1600px auto;
		}
		@media (max-width: 767px) {
			.site-header {
				background-size: 768px auto;
			}
		}
		@media (max-width: 359px) {
			.site-header {
				background-size: 360px auto;
			}
		}
		</style>
	</head>

<body class="archive paged category category-work category-3 paged-2 category-paged-2 single-author">
	<div id="page" class="hfeed site">
		<header id="masthead" class="site-header" role="banner">
			<a class="home-link" href="../../../../../index.html" title="Home of noocyte" rel="home">
				<h1 class="site-title">Home of noocyte</h1>
				<h2 class="site-description">Ramblings of a mad mind</h2>
			</a>

			<div id="navbar" class="navbar">
				<nav id="site-navigation" class="navigation main-navigation" role="navigation">
					<button class="menu-toggle">Menu</button>
					<a class="screen-reader-text skip-link" href="index.html#content" title="Skip to content">Skip to content</a>
					<div class="nav-menu"><ul><li class="page_item page-item-302"><a href="../../../../../index.html@p=302.html">About</a></li></ul></div>
					<form role="search" method="get" class="search-form" action="../../../../../index.html">
				<label>
					<span class="screen-reader-text">Search for:</span>
					<input type="search" class="search-field" placeholder="Search &hellip;" value="" name="s" title="Search for:" />
				</label>
				<input type="submit" class="search-submit" value="Search" />
			</form>				</nav><!-- #site-navigation -->
			</div><!-- #navbar -->
		</header><!-- #masthead -->

		<div id="main" class="site-main">

	<div id="primary" class="content-area">
		<div id="content" class="site-content" role="main">

					<header class="archive-header">
				<h1 class="archive-title">Category Archives: Geek</h1>

							</header><!-- .archive-header -->

										
<article id="post-373" class="post-373 post type-post status-publish format-standard hentry category-work tag-aspnet-mvc tag-automapper tag-entity-framework">
	<header class="entry-header">
		
				<h1 class="entry-title">
			<a href="../../../../../index.html@p=373.html" rel="bookmark">AutoMapper, aka AutoMagic</a>
		</h1>
		
		<div class="entry-meta">
			<span class="date"><a href="../../../../../index.html@p=373.html" title="Permalink to AutoMapper, aka AutoMagic" rel="bookmark"><time class="entry-date" datetime="2011-10-13T14:30:00+00:00">October 13, 2011</time></a></span><span class="categories-links"><a href="../../index.html" rel="category tag">Geek</a></span><span class="tags-links"><a href="../../../../../tag/aspnet-mvc/index.html" rel="tag">Asp.net mvc</a>, <a href="../../../../../tag/automapper/index.html" rel="tag">automapper</a>, <a href="../../../../../tag/entity-framework/index.html" rel="tag">entity framework</a></span><span class="author vcard"><a class="url fn n" href="../../../../../author/noocyte/index.html" title="View all posts by noocyte" rel="author">noocyte</a></span>					</div><!-- .entry-meta -->
	</header><!-- .entry-header -->

		<div class="entry-content">
		<p>&nbsp;</p>
<p><em>Update 27.10.2011: It turns out that the implementation below is not really all that good. The map created with the custom resolver will be cached; so all future results from a mapping process will use the initial value (enityTwoId). I reverted to ignoring the property during the mapping and then setting it manually afterwards.</em></p>
<p>We are currently working on a re-write of an application here at Proactima and in that process I’ve decided to use <a href="http://www.hanselman.com/blog/SimpleCodeFirstWithEntityFramework4MagicUnicornFeatureCTP4.aspx">EF 4.1 Magic Unicorn Edtion</a> as my backend. It supports <a href="http://en.wikipedia.org/wiki/Plain_Old_CLR_Object">POCO</a>s, but sometimes I don’t really wanna send the whole object to the view; so I create some view specific classes to use for this purpose. Mapping between the entity class and the view class would be tedious work was it not for the magic of <a href="http://automapper.org/">AutoMapper</a>! It handles the <a href="http://answers.yahoo.com/question/index?qid=20080903013225AAidwbW">RHS-LHS</a> mapping for me! How cool! But sometimes even magic needs a helping hand and AutoMapper accepts it!</p>
<p>These are my entity classes (not the actual classes…):</p>
<blockquote><p>public class EntityOne<br />{<br />&nbsp;&nbsp;&nbsp; public int EntityOneID { get; set; }<br />&nbsp;&nbsp;&nbsp; public string Title { get; set; }<br />&nbsp;&nbsp;&nbsp; public virtual ICollection&lt;EntityTwo&gt; EntityTwos { get; set; }<br />}</p>
<p>public class EntityTwo<br />{<br />&nbsp;&nbsp;&nbsp; public int EntityTwoID { get; set; }<br />&nbsp;&nbsp;&nbsp; public string SomeInformation { get; set; }<br />&nbsp;&nbsp;&nbsp; public int EntityOneID { get; set; }<br />&nbsp;&nbsp;&nbsp; public virtual EntityOne EntityOne { get; set; }<br />}</p>
</blockquote>
<p>And these should be mapped to these classes:</p>
<blockquote><p>public class EntityOneView<br />{<br />&nbsp;&nbsp;&nbsp; public int EntityOneID { get; set; }<br />&nbsp;&nbsp;&nbsp; public string Title { get; set; }<br />&nbsp;&nbsp;&nbsp; public virtual EntityTwoView EntityTwo { get; set; }<br />}</p>
<p>public class EntityTwoView<br />{<br />&nbsp;&nbsp;&nbsp; public int EntityTwoID { get; set; }<br />&nbsp;&nbsp;&nbsp; public string SomeInformation { get; set; }&nbsp;&nbsp; <br />}</p>
</blockquote>
<p>Basically I only bring with me one of the “EntityTwoView” objects, as opposed to a list in the entity class. Naturally in an actual application the classes would be FAR more complex than these, but I needed this to illustrate the point. I find it easier to understand code where there is little or no noise.</p>
<p>Given an “EntityOne” object I now want to map/convert it to an “EntityOneView” object before sending it of the the view (from the controller in ASP.Net MVC). If I didn’t have to list-&gt;one issue I could simply write these two lines:</p>
<blockquote><p>EntityOne one = db.Load&lt;EntityOne&gt;(1);<br />Mapper.CreateMap&lt;EntityOne, EntityOneView&gt;();<br />EntityOneView oneView = Mapper.Map&lt;EntityOneView&gt;(one);</p>
</blockquote>
<p>But this will fail since AutoMapper have no idea on how to go from a list of EntityTwo’s to a single EntityTwo. So I have to help her (?) out a bit. I can do that by writing a <a href="http://automapper.codeplex.com/wikipage?title=Custom%20Value%20Resolvers">Custom Value Resolver</a>. It would for this code look like this:</p>
<blockquote><p>public class SingleLineResolver : ValueResolver&lt;EntityOne, EntityTwoView&gt;<br />{<br />&nbsp;&nbsp;&nbsp; private int EntityTwoId { get; set; }<br />&nbsp;&nbsp;&nbsp; public SingleLineResolver(int entityTwoId)<br />&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; this.EntityTwoId = entityTwoId;<br />&nbsp;&nbsp;&nbsp; }</p>
<p>&nbsp;&nbsp;&nbsp; protected override EntityTwoView ResolveCore(EntityOne source)<br />&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Mapper.CreateMap&lt;EntityTwo, EntityTwoView&gt;();<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var line = source.EntityTwos.First(e=&gt; e.EntityTwoID == this.EntityTwoId);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return Mapper.Map&lt;EntityTwoView&gt;(line);<br />&nbsp;&nbsp;&nbsp; }<br />}</p>
</blockquote>
<p>This code took me awhile to understand and be able to write… Now I might be stupid and you smart, so perhaps I’m the only one struggeling with this one… But to make use of it I had to update the previous code to:</p>
<blockquote><p>EntityOne one = new EntityOne();<br />SingleLineResolver resolver = new SingleLineResolver(2);<br />Mapper.CreateMap&lt;EntityOne, EntityOneView&gt;()<br />&nbsp;&nbsp;&nbsp; .ForMember(dest =&gt; dest.EntityTwo, opt =&gt; opt.ResolveUsing(resolver));<br />EntityOneView oneView = Mapper.Map&lt;EntityOneView&gt;(one);</p>
</blockquote>
<p>Here I am basically saying that when you (AutoMapper) create the mapping between EntityOne and EntityOneView and come to the “EntityTwo” property (on the EntityOneView object) please use my custom value resolver (resolver) to figure out the value of that property. It will then send the “one” object into my custom value resolver class (SingleLineResolver) and the output will be set as the value of the property called “EntityTwo” on the new object of type “EntityOneView”; Puh! </p>
<p>Basically AutoMapper let’s me use two objects (or more!) that are fairly similar and map between them. She (?) will handle complex scenarios like this and much, much more. I hereby dub the project “AutoMagic”. </p>
<p><em>Please note that the code I present here has been severly altered from the actual production code, so please don’t shoot me if it fails to work as expected!</em></p>
	</div><!-- .entry-content -->
	
	<footer class="entry-meta">
					<div class="comments-link">
				<a href="../../../../../index.html@p=373.html#respond"><span class="leave-reply">Leave a comment</span></a>			</div><!-- .comments-link -->
		
			</footer><!-- .entry-meta -->
</article><!-- #post -->
							
<article id="post-372" class="post-372 post type-post status-publish format-standard hentry category-work tag-mvc tag-security">
	<header class="entry-header">
		
				<h1 class="entry-title">
			<a href="../../../../../index.html@p=372.html" rel="bookmark">Howto use configurable rolenames to authorize attribute</a>
		</h1>
		
		<div class="entry-meta">
			<span class="date"><a href="../../../../../index.html@p=372.html" title="Permalink to Howto use configurable rolenames to authorize attribute" rel="bookmark"><time class="entry-date" datetime="2011-10-10T12:40:00+00:00">October 10, 2011</time></a></span><span class="categories-links"><a href="../../index.html" rel="category tag">Geek</a></span><span class="tags-links"><a href="../../../../../tag/mvc/index.html" rel="tag">mvc</a>, <a href="../../../../../tag/security/index.html" rel="tag">security</a></span><span class="author vcard"><a class="url fn n" href="../../../../../author/noocyte/index.html" title="View all posts by noocyte" rel="author">noocyte</a></span>					</div><!-- .entry-meta -->
	</header><!-- .entry-header -->

		<div class="entry-content">
		<p>For one of my ASP.Net MVC 3 projects I make heavy use of the “[Authorize(Roles=…)]” syntax, but the fact that I have to type in the rolename there always rubbed me the wrong way. I started to experiment to see if I could perhaps use some code to get the rolename from configuration or something. By default I could not, but it was possible to inherit from the Authorize attribute and create my own to make this possible. And so that’s what I did, here is the code:</p>
<blockquote><p>public class SecureAttribute : AuthorizeAttribute<br />{<br />&nbsp;&nbsp;&nbsp;&nbsp; public SecureAttribute() : this(true)<br />&nbsp;&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp; }</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp; public SecureAttribute(bool requireAdmin) : base()<br />&nbsp;&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (requireAdmin)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; this.Roles = Configuration.AdminRoleName;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />&nbsp;&nbsp;&nbsp;&nbsp; }<br />}</p>
</blockquote>
<p>To use it:</p>
<blockquote><p>[Secure]<br />public abstract class SecureController : Controller</p>
</blockquote>
<p>Basically all I do is add two constructors to enable me to set the “Roles” property to whatever I have configured it to be. Now, this code is tailor to my specific project, so you wanna change stuff to match your requirements. Please also note that I use a “SecureController” that all my Controllers inherit from if they require Admin access. I did this to save exactly one line of code on all of my controllers! So instead of inheriting from just “Controller” and adding the “Secure” attribute they just inherit from “SecureController”, which has the attribute and inherits from “Controller”. Perhaps a bit over the top, but you never know; one day I might add some more stuff here.</p>
<p>If anyone can see anything wrong with this implementation, please let me know! I am fairly new to MVC and the ASP.Net Membership stuff… <img style="border-style:none;" class="wlEmoticon wlEmoticon-smile" alt="Smilefjes" src="http://noocyte.files.wordpress.com/2011/10/wlemoticon-smile.png"></p>
	</div><!-- .entry-content -->
	
	<footer class="entry-meta">
					<div class="comments-link">
				<a href="../../../../../index.html@p=372.html#respond"><span class="leave-reply">Leave a comment</span></a>			</div><!-- .comments-link -->
		
			</footer><!-- .entry-meta -->
</article><!-- #post -->
							
<article id="post-347" class="post-347 post type-post status-publish format-standard hentry category-work tag-generics tag-mvc">
	<header class="entry-header">
		
				<h1 class="entry-title">
			<a href="../../../../../index.html@p=347.html" rel="bookmark">MVC 3, EF 4.1 and some more…</a>
		</h1>
		
		<div class="entry-meta">
			<span class="date"><a href="../../../../../index.html@p=347.html" title="Permalink to MVC 3, EF 4.1 and some more…" rel="bookmark"><time class="entry-date" datetime="2011-10-04T09:33:00+00:00">October 4, 2011</time></a></span><span class="categories-links"><a href="../../index.html" rel="category tag">Geek</a></span><span class="tags-links"><a href="../../../../../tag/generics/index.html" rel="tag">generics</a>, <a href="../../../../../tag/mvc/index.html" rel="tag">mvc</a></span><span class="author vcard"><a class="url fn n" href="../../../../../author/noocyte/index.html" title="View all posts by noocyte" rel="author">noocyte</a></span>					</div><!-- .entry-meta -->
	</header><!-- .entry-header -->

		<div class="entry-content">
		<p>So I’ve begun work on a new application, using ASP.Net MVC 3 (with Razor) and Entity Framework 4.1 (Code First). So far it looks like a good combo of technology, some head-aches and obstacles, but with the help of Google I’ve found my way through them all.</p>
<p>Earlier today I needed to do an “if check” before printing some data on a page, so I did something like this:</p>
<blockquote><p>@if(!String.IsNullOrEmpty(item.Compliant))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; @Html.DisplayFor(modelItem =&gt; item.Deadline, Model)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</p>
</blockquote>
<p>And then on the next line I did the exact same, but for a different property (ie. not “Deadline”). I felt a slight pain as I repeated myself (ie. the if test) and started to look at how to avoid that. I tried a number of different things, all documented below.</p>
<h3>1. Custom code to do check and return value</h3>
<p>My first attempt was to just take the code out of the view and put it in a static class. The code looked a little like this:</p>
<blockquote><p>public static string DisplayBasedOnCompliantStatus(SomeClass eval, string displayText)<br />{<br />&nbsp;&nbsp;&nbsp; if (!String.IsNullOrWhiteSpace(eval.Compliant) &amp;&amp; eval.Compliant.Equals(&#8220;Yes&#8221;, StringComparison.InvariantCultureIgnoreCase))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return displayText;</p>
<p>&nbsp;&nbsp;&nbsp; return String.Empty;<br />}</p>
</blockquote>
<p>This code worked as expected, but the return value was a string, so I lost the dataformatting of the input value (DateTime). So i figured there had to be a better way… </p>
<h3>2. Reuse of “DisplayFor” extension methods</h3>
<p>For my next attempt I tried to take as input whatever I needed to use to call the “Html.DisplayFor” method I used in the view code. One of my attempts looked a little like this:</p>
<blockquote><p>public static MvcHtmlString DisplayOnlyIfCompliant&lt;TValue&gt;(HtmlHelper&lt;TModel&gt; html, TModel model, Expression&lt;Func&lt;TModel, string&gt;&gt; compliantExpression, Expression&lt;Func&lt;TModel, TValue&gt;&gt; expression)<br />{<br />&nbsp;&nbsp;&nbsp; Func&lt;TModel, string&gt; deleg = compliantExpression.Compile();<br />&nbsp;&nbsp;&nbsp; var compliant = deleg(model);<br />&nbsp;&nbsp;&nbsp; if (!String.IsNullOrWhiteSpace(compliant) &amp;&amp; compliant.Equals(&#8220;Yes&#8221;, StringComparison.InvariantCultureIgnoreCase))<br />&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return html.DisplayFor(expression);<br />&nbsp;&nbsp;&nbsp; }</p>
<p>&nbsp;&nbsp;&nbsp; return new MvcHtmlString(null);<br />}</p>
</blockquote>
<p>This I could never make work, not even compile, but I felt as if I was on the right track. </p>
<h3>3. Create another extension method</h3>
<p>For my third attempt I had a very close look at the orignal method (“Html.DisplayFor”) and suddenly realized that it was an extension method and I could probably create another extension method myself! So the third attempt looks like this:</p>
<blockquote><p>public static MvcHtmlString DisplayFor&lt;TModel, TValue&gt;(this HtmlHelper&lt;TModel&gt; html, Expression&lt;Func&lt;TModel, TValue&gt;&gt; expression, SomeClass model)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (!String.IsNullOrWhiteSpace(model.Compliant) &amp;&amp; model.Compliant.Equals(&#8220;Yes&#8221;, StringComparison.InvariantCultureIgnoreCase))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return html.DisplayFor&lt;TModel, TValue&gt;(expression);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return new MvcHtmlString(null);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</p>
</blockquote>
<p>And what-do-you-know? It works! To use it all I had to do was this:</p>
<blockquote><p>@Html.DisplayFor(modelItem =&gt; item.Deadline, Model)</p>
</blockquote>
<p>But when looking at the code I can see that it’s a little less flexible than it could have been. What if I need the same functionality for another property beside “Compliant”? Then I have to create another method, rename the original (it already has a bad name!) and then I’m back to repeating myself! So a fourth attempt should be tried!</p>
<h3>4. generic Extension method</h3>
<p>My final requirement is that the extension method can handle any model to check for null-string. This meant that I had to take the model specific code out of my extension method and add another parameter to be able to define the property to check for null-string. The code looks like this:</p>
<blockquote><p>&nbsp;&nbsp;&nbsp; public static MvcHtmlString DisplayFor&lt;TModel, TValue&gt;(<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; this HtmlHelper&lt;TModel&gt; html, <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Expression&lt;Func&lt;TModel, TValue&gt;&gt; expression, <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Expression&lt;Func&lt;TModel, string&gt;&gt; compliantExpression,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; TModel model)<br />&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var compliant = compliantExpression<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .Compile()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .Invoke(model);</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (!String.IsNullOrWhiteSpace(compliant) &amp;&amp; compliant.Equals(&#8220;Yes&#8221;, StringComparison.InvariantCultureIgnoreCase))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return html.DisplayFor&lt;TModel, TValue&gt;(expression);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return new MvcHtmlString(null);<br />&nbsp;&nbsp;&nbsp; }<br />}</p>
</blockquote>
<p>And in use:</p>
<blockquote><p>@Html.DisplayFor(m =&gt; item.PropertyToDisplay, c =&gt; item.PropertyToCheck, Model)</p>
</blockquote>
<p>I guess it would be possible to do a more generic “null check”, so let’s make a fifth attempt… </p>
<h3>5. 100% Pure Generic Extension Method</h3>
<p>The final step in making the extension method 100% pure from any “non-generic noise” is to remove the “string” part in the “compliantExpression” input definition. There is really just one obstacle to make that happen; I need a generic null check. I tried using “IComparable” and requiring the input type to inherit from it, but this caused some issues when it was null (NullReferenceException). So I had to do a som Googling and found a <a href="http://stackoverflow.com/questions/65351/null-or-default-comparsion-of-generic-argument-in-c">great question</a> on <a href="http://stackoverflow.com/">Stackoverflow</a> that helped me out! Turns out I can write the method like this:</p>
<blockquote><p>public static MvcHtmlString DisplayFor&lt;TModel, TValue, TCheck&gt;(<br />this HtmlHelper&lt;TModel&gt; html,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Expression&lt;Func&lt;TModel, TValue&gt;&gt; expression,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Expression&lt;Func&lt;TModel, TCheck&gt;&gt; compliantExpression,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; TModel model)</p>
<p>{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; TCheck compliant = compliantExpression<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .Compile()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .Invoke(model);</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (!Equals(compliant, default(TCheck)))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return html.DisplayFor&lt;TModel, TValue&gt;(expression);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return new MvcHtmlString(null);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />}</p>
</blockquote>
<p>And of course no need to adjust how we call the method, since types are inferred when using expressions (I guess?). </p>
<p>There is however a serious issue with the extension method now; I’ m only testing for “null”, not for an actual value compare, which of course I need… So, enter attempt number six.</p>
<h3>6. 100% Pure Generic Extenstion Method with compare function</h3>
<p>I had to make it possible to compare the actual value with a provided value, such as “Yes” or “1”. To do this I needed to add a parameter to the method enabling the caller to input a function to compare the value of “valueExpression” with a caller defined value. It now looks like this:</p>
<blockquote><p>public static MvcHtmlString DisplayForIfEqual&lt;TModel, TValue, TCheck&gt;(<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; this HtmlHelper&lt;TModel&gt; html,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Expression&lt;Func&lt;TModel, TValue&gt;&gt; valueExpression,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Expression&lt;Func&lt;TModel, TCheck&gt;&gt; checkExpression,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Func&lt;TCheck, bool&gt; compareFunction,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; TModel model)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; TCheck checkValue = checkExpression<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .Compile()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .Invoke(model);</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (!Equals(checkValue, default(TCheck)) &amp;&amp; compareFunction(checkValue))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return html.DisplayFor&lt;TModel, TValue&gt;(valueExpression);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return new MvcHtmlString(null);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</p>
</blockquote>
<p>To call it:</p>
<blockquote><p>@Html.DisplayForIfEqual(<br />m =&gt; item.SomeDisplayProperty, <br />c =&gt; item.SomeCheckProperty,<br />m =&gt; m.Equals(&#8220;No&#8221;, StringComparison.InvariantCultureIgnoreCase),<br />Model)</p>
</blockquote>
<p>A curiosity is that the “m” variable does not give you IntelliSense in Visual Studio today. I was puzzled by this, but no big deal really. </p>
<p>There might be some issues with the “Equals” method in the null-check (like boxing), but for now I’ll be using this method.</p>
	</div><!-- .entry-content -->
	
	<footer class="entry-meta">
					<div class="comments-link">
				<a href="../../../../../index.html@p=347.html#comments">One comment so far</a>			</div><!-- .comments-link -->
		
			</footer><!-- .entry-meta -->
</article><!-- #post -->
							
<article id="post-344" class="post-344 post type-post status-publish format-standard hentry category-work">
	<header class="entry-header">
		
				<h1 class="entry-title">
			<a href="../../../../../index.html@p=344.html" rel="bookmark">Great new utility discovered</a>
		</h1>
		
		<div class="entry-meta">
			<span class="date"><a href="../../../../../index.html@p=344.html" title="Permalink to Great new utility discovered" rel="bookmark"><time class="entry-date" datetime="2011-09-22T07:00:03+00:00">September 22, 2011</time></a></span><span class="categories-links"><a href="../../index.html" rel="category tag">Geek</a></span><span class="author vcard"><a class="url fn n" href="../../../../../author/noocyte/index.html" title="View all posts by noocyte" rel="author">noocyte</a></span>					</div><!-- .entry-meta -->
	</header><!-- .entry-header -->

		<div class="entry-content">
		<p>Yesterday I was working on one of our internal projects and one of the requirements was to read some data from Excel/CSV files. I did a &#8220;<a href="http://www.bing.com/search?q=C%23+read+csv+files&amp;go=&amp;form=QBLH&amp;filt=all">Google with Bing</a>&#8221; and found some interesting projects on CodeProject. But one of the <a href="http://stackoverflow.com/questions/1405038/reading-csv-files-in-net">answers </a>on StackOverflow pointed to <a href="http://www.filehelpers.com/">FileHelpers</a>. Just a wonderful little utility that can read both Excel and CSV files for me in just a few lines! I installed it using <a href="http://nuget.org/">NuGet</a> of course. Rarely have I been so happy for something so small! <img src="../../../../../wp-includes/images/smilies/simple-smile.png" alt=":)" class="wp-smiley" style="height: 1em; max-height: 1em;" /></p>
	</div><!-- .entry-content -->
	
	<footer class="entry-meta">
					<div class="comments-link">
				<a href="../../../../../index.html@p=344.html#respond"><span class="leave-reply">Leave a comment</span></a>			</div><!-- .comments-link -->
		
			</footer><!-- .entry-meta -->
</article><!-- #post -->
							
<article id="post-337" class="post-337 post type-post status-publish format-standard post-password-required hentry category-work tag-browser tag-ie6 tag-ie7">
	<header class="entry-header">
		
				<h1 class="entry-title">
			<a href="../../../../../index.html@p=337.html" rel="bookmark">Protected: Paying the IE6 tax</a>
		</h1>
		
		<div class="entry-meta">
			<span class="date"><a href="../../../../../index.html@p=337.html" title="Permalink to Protected: Paying the IE6 tax" rel="bookmark"><time class="entry-date" datetime="2009-10-26T10:28:33+00:00">October 26, 2009</time></a></span><span class="categories-links"><a href="../../index.html" rel="category tag">Geek</a></span><span class="tags-links"><a href="../../../../../tag/browser/index.html" rel="tag">browser</a>, <a href="../../../../../tag/ie6/index.html" rel="tag">ie6</a>, <a href="../../../../../tag/ie7/index.html" rel="tag">ie7</a></span><span class="author vcard"><a class="url fn n" href="../../../../../author/noocyte/index.html" title="View all posts by noocyte" rel="author">noocyte</a></span>					</div><!-- .entry-meta -->
	</header><!-- .entry-header -->

		<div class="entry-content">
		<form action="http://blog.noocyte.net/wp-login.php?action=postpass" class="post-password-form" method="post">
<p>This content is password protected. To view it please enter your password below:</p>
<p><label for="pwbox-337">Password: <input name="post_password" id="pwbox-337" type="password" size="20" /></label> <input type="submit" name="Submit" value="Submit" /></p>
</form>
	</div><!-- .entry-content -->
	
	<footer class="entry-meta">
					<div class="comments-link">
				Enter your password to view comments.			</div><!-- .comments-link -->
		
			</footer><!-- .entry-meta -->
</article><!-- #post -->
							
<article id="post-334" class="post-334 post type-post status-publish format-standard hentry category-work tag-code tag-code-nazi tag-dry">
	<header class="entry-header">
		
				<h1 class="entry-title">
			<a href="../../../../../index.html@p=334.html" rel="bookmark">DRY in the real world</a>
		</h1>
		
		<div class="entry-meta">
			<span class="date"><a href="../../../../../index.html@p=334.html" title="Permalink to DRY in the real world" rel="bookmark"><time class="entry-date" datetime="2009-08-27T09:24:00+00:00">August 27, 2009</time></a></span><span class="categories-links"><a href="../../index.html" rel="category tag">Geek</a></span><span class="tags-links"><a href="../../../../../tag/code/index.html" rel="tag">code</a>, <a href="../../../../../tag/code-nazi/index.html" rel="tag">code nazi</a>, <a href="../../../../../tag/dry/index.html" rel="tag">dry</a></span><span class="author vcard"><a class="url fn n" href="../../../../../author/noocyte/index.html" title="View all posts by noocyte" rel="author">noocyte</a></span>					</div><!-- .entry-meta -->
	</header><!-- .entry-header -->

		<div class="entry-content">
		<p>In programming there are many, many principles. One of the more useful ones that I’ve discovered lately is <a href="http://en.wikipedia.org/wiki/Don%27t_repeat_yourself">DRY</a>: <strong>Don’t Repeat Yourself</strong>. It’s simple really, never ever copy code and don’t write the same code twice. In the real world it might not be as easy though… </p>
<p>Today I was about to check in some code and I went through my regular check-in routine (you have one as well I presume?) and discovered that I was violating DRY! At least if you’re being anal about it… The code in question was a little like this: (slightly altered to protect the innocents)</p>
<div style="border-bottom:silver 1px solid;text-align:left;border-left:silver 1px solid;line-height:12pt;background-color:#f4f4f4;width:97.5%;font-family:&#39;direction:ltr;max-height:200px;font-size:8pt;overflow:auto;border-top:silver 1px solid;cursor:text;border-right:silver 1px solid;margin:20px 0 10px;padding:4px;" id="codeSnippetWrapper">
<div style="text-align:left;line-height:12pt;background-color:#f4f4f4;width:100%;font-family:&#39;direction:ltr;color:black;font-size:8pt;overflow:visible;border-style:none;padding:0;" id="codeSnippet">
<pre style="text-align:left;line-height:12pt;background-color:white;width:100%;font-family:&#39;direction:ltr;color:black;font-size:8pt;overflow:visible;border-style:none;margin:0;padding:0;"><span style="color:#606060;" id="lnum1">   1:</span> <span style="color:#0000ff;">using</span> (SPSite site = <span style="color:#0000ff;">new</span> SPSite(url)) {</pre>
<p><!--CRLF--></p>
<pre style="text-align:left;line-height:12pt;background-color:#f4f4f4;width:100%;font-family:&#39;direction:ltr;color:black;font-size:8pt;overflow:visible;border-style:none;margin:0;padding:0;"><span style="color:#606060;" id="lnum2">   2:</span>     <span style="color:#0000ff;">using</span> (SPWeb web = site.OpenWeb()) {</pre>
<p><!--CRLF--></p>
<pre style="text-align:left;line-height:12pt;background-color:white;width:100%;font-family:&#39;direction:ltr;color:black;font-size:8pt;overflow:visible;border-style:none;margin:0;padding:0;"><span style="color:#606060;" id="lnum3">   3:</span>         lang = web.Language;</pre>
<p><!--CRLF--></p>
<pre style="text-align:left;line-height:12pt;background-color:#f4f4f4;width:100%;font-family:&#39;direction:ltr;color:black;font-size:8pt;overflow:visible;border-style:none;margin:0;padding:0;"><span style="color:#606060;" id="lnum4">   4:</span>     }</pre>
<p><!--CRLF--></p>
<pre style="text-align:left;line-height:12pt;background-color:white;width:100%;font-family:&#39;direction:ltr;color:black;font-size:8pt;overflow:visible;border-style:none;margin:0;padding:0;"><span style="color:#606060;" id="lnum5">   5:</span> }</pre>
<p><!--CRLF--></div>
</div>
<p>(I didn’t really return the language, but no need to include all of the source code)</p>
<p>So I was doing the double using in 4-5 places; a clear violation of DRY in my book. So what I did was this:</p>
<div style="border-bottom:silver 1px solid;text-align:left;border-left:silver 1px solid;line-height:12pt;background-color:#f4f4f4;width:97.5%;font-family:&#39;direction:ltr;max-height:200px;font-size:8pt;overflow:auto;border-top:silver 1px solid;cursor:text;border-right:silver 1px solid;margin:20px 0 10px;padding:4px;" id="codeSnippetWrapper">
<div style="text-align:left;line-height:12pt;background-color:#f4f4f4;width:100%;font-family:&#39;direction:ltr;color:black;font-size:8pt;overflow:visible;border-style:none;padding:0;" id="codeSnippet">
<pre style="text-align:left;line-height:12pt;background-color:white;width:100%;font-family:&#39;direction:ltr;color:black;font-size:8pt;overflow:visible;border-style:none;margin:0;padding:0;"><span style="color:#606060;" id="lnum1">   1:</span> <span style="color:#0000ff;">private</span> T OpenSiteWeb&lt;T&gt;(<span style="color:#0000ff;">string</span> url, Func&lt;SPSite, SPWeb, T&gt; implementingMember) {</pre>
<p><!--CRLF--></p>
<pre style="text-align:left;line-height:12pt;background-color:#f4f4f4;width:100%;font-family:&#39;direction:ltr;color:black;font-size:8pt;overflow:visible;border-style:none;margin:0;padding:0;"><span style="color:#606060;" id="lnum2">   2:</span>    <span style="color:#0000ff;">using</span> (SPSite site = <span style="color:#0000ff;">new</span> SPSite(url)) {</pre>
<p><!--CRLF--></p>
<pre style="text-align:left;line-height:12pt;background-color:white;width:100%;font-family:&#39;direction:ltr;color:black;font-size:8pt;overflow:visible;border-style:none;margin:0;padding:0;"><span style="color:#606060;" id="lnum3">   3:</span>        <span style="color:#0000ff;">using</span> (SPWeb web = site.OpenWeb()) {</pre>
<p><!--CRLF--></p>
<pre style="text-align:left;line-height:12pt;background-color:#f4f4f4;width:100%;font-family:&#39;direction:ltr;color:black;font-size:8pt;overflow:visible;border-style:none;margin:0;padding:0;"><span style="color:#606060;" id="lnum4">   4:</span>            <span style="color:#0000ff;">return</span> implementingMember(site, web);</pre>
<p><!--CRLF--></p>
<pre style="text-align:left;line-height:12pt;background-color:white;width:100%;font-family:&#39;direction:ltr;color:black;font-size:8pt;overflow:visible;border-style:none;margin:0;padding:0;"><span style="color:#606060;" id="lnum5">   5:</span>        }</pre>
<p><!--CRLF--></p>
<pre style="text-align:left;line-height:12pt;background-color:#f4f4f4;width:100%;font-family:&#39;direction:ltr;color:black;font-size:8pt;overflow:visible;border-style:none;margin:0;padding:0;"><span style="color:#606060;" id="lnum6">   6:</span>    }</pre>
<p><!--CRLF--></p>
<pre style="text-align:left;line-height:12pt;background-color:white;width:100%;font-family:&#39;direction:ltr;color:black;font-size:8pt;overflow:visible;border-style:none;margin:0;padding:0;"><span style="color:#606060;" id="lnum7">   7:</span> }</pre>
<p><!--CRLF--></div>
</div>
<p>This method I can use like this:</p>
<div style="border-bottom:silver 1px solid;text-align:left;border-left:silver 1px solid;line-height:12pt;background-color:#f4f4f4;width:97.5%;font-family:&#39;direction:ltr;max-height:200px;font-size:8pt;overflow:auto;border-top:silver 1px solid;cursor:text;border-right:silver 1px solid;margin:20px 0 10px;padding:4px;" id="codeSnippetWrapper">
<div style="text-align:left;line-height:12pt;background-color:#f4f4f4;width:100%;font-family:&#39;direction:ltr;color:black;font-size:8pt;overflow:visible;border-style:none;padding:0;" id="codeSnippet">
<pre style="text-align:left;line-height:12pt;background-color:white;width:100%;font-family:&#39;direction:ltr;color:black;font-size:8pt;overflow:visible;border-style:none;margin:0;padding:0;"><span style="color:#606060;" id="lnum1">   1:</span> lang = OpenSiteWeb&lt;<span style="color:#0000ff;">uint</span>&gt;(url, (s, w) =&gt;</pre>
<p><!--CRLF--></p>
<pre style="text-align:left;line-height:12pt;background-color:#f4f4f4;width:100%;font-family:&#39;direction:ltr;color:black;font-size:8pt;overflow:visible;border-style:none;margin:0;padding:0;"><span style="color:#606060;" id="lnum2">   2:</span> {</pre>
<p><!--CRLF--></p>
<pre style="text-align:left;line-height:12pt;background-color:white;width:100%;font-family:&#39;direction:ltr;color:black;font-size:8pt;overflow:visible;border-style:none;margin:0;padding:0;"><span style="color:#606060;" id="lnum3">   3:</span>     <span style="color:#0000ff;">return</span> w.Language;</pre>
<p><!--CRLF--></p>
<pre style="text-align:left;line-height:12pt;background-color:#f4f4f4;width:100%;font-family:&#39;direction:ltr;color:black;font-size:8pt;overflow:visible;border-style:none;margin:0;padding:0;"><span style="color:#606060;" id="lnum4">   4:</span> }</pre>
<p><!--CRLF--></div>
</div>
<p>Pretty neat, no? It might be overkill, but fun code to write anyway! </p>
	</div><!-- .entry-content -->
	
	<footer class="entry-meta">
					<div class="comments-link">
				<a href="../../../../../index.html@p=334.html#respond"><span class="leave-reply">Leave a comment</span></a>			</div><!-- .comments-link -->
		
			</footer><!-- .entry-meta -->
</article><!-- #post -->
							
<article id="post-333" class="post-333 post type-post status-publish format-standard hentry category-work category-link tag-contest tag-isolator tag-sharepoint tag-typemock tag-unit-testing">
	<header class="entry-header">
		
				<h1 class="entry-title">
			<a href="../../../../../index.html@p=333.html" rel="bookmark">Announcing Isolator for Sharepoint with a free full license for bloggers &#8211; ISerializable &#8211; Roy Osherove&#8217;s Blog</a>
		</h1>
		
		<div class="entry-meta">
			<span class="date"><a href="../../../../../index.html@p=333.html" title="Permalink to Announcing Isolator for Sharepoint with a free full license for bloggers &#8211; ISerializable &#8211; Roy Osherove&#8217;s Blog" rel="bookmark"><time class="entry-date" datetime="2008-11-27T16:45:49+00:00">November 27, 2008</time></a></span><span class="categories-links"><a href="../../index.html" rel="category tag">Geek</a>, <a href="../../../link/index.html" rel="category tag">Link</a></span><span class="tags-links"><a href="../../../../../tag/contest/index.html" rel="tag">contest</a>, <a href="../../../../../tag/isolator/index.html" rel="tag">isolator</a>, <a href="../../../../../tag/sharepoint/index.html" rel="tag">sharepoint</a>, <a href="../../../../../tag/typemock/index.html" rel="tag">typemock</a>, <a href="../../../../../tag/unit-testing/index.html" rel="tag">unit testing</a></span><span class="author vcard"><a class="url fn n" href="../../../../../author/noocyte/index.html" title="View all posts by noocyte" rel="author">noocyte</a></span>					</div><!-- .entry-meta -->
	</header><!-- .entry-header -->

		<div class="entry-content">
		<p>We’re just now starting a huge Sharepoint project and this new edition of Isolator might be good for that project. I’ll need to try it out!</p>
<p>And they’re even giving it away for free! 50 licenses anyways. I’m hoping there’s one for me! For that to happen I have to include this text:</p>
<blockquote><p>Typemock are offering their new product for <a href="http://www.typemock.com/sharepointpage.php?utm_source=sp_bb&amp;utm_medium=blog_4sp&amp;utm_campaign=sp_bb">unit testing SharePoint</a> called Isolator For SharePoint, for a special introduction price. it is the only tool that allows you to <a href="http://blog.typemock.com/2008/11/newisolatorforsharepointtoolforunittest.html?utm_source=typeblog&amp;utm_medium=sp_bb&amp;utm_campaign=typeblog">unit test SharePoint</a> without a SharePoint server. To learn more <a href="http://www.typemock.com/sharepointpage.php?utm_source=sp_bb&amp;utm_medium=blog_4sp&amp;utm_campaign=sp_bb">click here</a>. </p>
<p><strong>The first 50 bloggers </strong>who blog this text in their blog and tell us about it, will get a Full Isolator license, Free. for rules and info <a href="http://blog.typemock.com/2008/11/newisolatorforsharepointtoolforunittest.html">click here</a>. </p>
<p><a href="http://weblogs.asp.net/rosherove/archive/2008/11/24/announcing-isolator-for-sharepoint-with-a-free-full-license-for-bloggers.aspx">Announcing Isolator for Sharepoint with a free full license </a></p>
</blockquote>
<p><font color="#777777">So that’s cool! So, if I do happen to get a free license I’ll tell you all about it, right here!</font></p>
<p>for bloggers &#8211; ISerializable &#8211; Roy Osherove&#8217;s Blog</p>
	</div><!-- .entry-content -->
	
	<footer class="entry-meta">
					<div class="comments-link">
				<a href="../../../../../index.html@p=333.html#respond"><span class="leave-reply">Leave a comment</span></a>			</div><!-- .comments-link -->
		
			</footer><!-- .entry-meta -->
</article><!-- #post -->
							
<article id="post-332" class="post-332 post type-post status-publish format-standard hentry category-work category-link tag-betting-the-farm tag-holy-cow tag-silverlight">
	<header class="entry-header">
		
				<h1 class="entry-title">
			<a href="../../../../../index.html@p=332.html" rel="bookmark">Update on Silverlight 2 &#8211; and a glimpse of Silverlight 3 &#8211; ScottGu&#8217;s Blog</a>
		</h1>
		
		<div class="entry-meta">
			<span class="date"><a href="../../../../../index.html@p=332.html" title="Permalink to Update on Silverlight 2 &#8211; and a glimpse of Silverlight 3 &#8211; ScottGu&#8217;s Blog" rel="bookmark"><time class="entry-date" datetime="2008-11-17T10:13:20+00:00">November 17, 2008</time></a></span><span class="categories-links"><a href="../../index.html" rel="category tag">Geek</a>, <a href="../../../link/index.html" rel="category tag">Link</a></span><span class="tags-links"><a href="../../../../../tag/betting-the-farm/index.html" rel="tag">betting the farm</a>, <a href="../../../../../tag/holy-cow/index.html" rel="tag">holy cow</a>, <a href="../../../../../tag/silverlight/index.html" rel="tag">silverlight</a></span><span class="author vcard"><a class="url fn n" href="../../../../../author/noocyte/index.html" title="View all posts by noocyte" rel="author">noocyte</a></span>					</div><!-- .entry-meta -->
	</header><!-- .entry-header -->

		<div class="entry-content">
		<p>Holy cow! Silverlight 2 was just released and ScottGu mentions some of the improvements coming in the next major versjon; Silverlight 3. </p>
<blockquote><p>Next year we will ship our next major Silverlight release &#8212; Silverlight 3. </p>
<p>Silverlight 3 will include major media enhancements (including H.264 video support), major graphics improvements (including 3D support and GPU hardware acceleration), as well as major application development improvements (including richer data-binding support and additional controls). Note these are just a small sampling of the improvements &#8211; we have plenty of additional cool features we are going to keep up our sleeves a little longer.</p>
</blockquote>
<p><font color="#777777">Looks like Microsoft is pouring a lot of resources into Silverlight. I’d have no issues <a href="http://idioms.thefreedictionary.com/betting+the+farm">betting the farm</a> on Silverlight.</font></p>
<p><a href="http://weblogs.asp.net/scottgu/archive/2008/11/16/update-on-silverlight-2-and-a-glimpse-of-silverlight-3.aspx">Update on Silverlight 2 &#8211; and a glimpse of Silverlight 3 &#8211; ScottGu&#8217;s Blog</a></p>
	</div><!-- .entry-content -->
	
	<footer class="entry-meta">
					<div class="comments-link">
				<a href="../../../../../index.html@p=332.html#comments">One comment so far</a>			</div><!-- .comments-link -->
		
			</footer><!-- .entry-meta -->
</article><!-- #post -->
							
<article id="post-331" class="post-331 post type-post status-publish format-standard post-password-required hentry category-work tag-agile tag-process tag-scrum">
	<header class="entry-header">
		
				<h1 class="entry-title">
			<a href="../../../../../index.html@p=331.html" rel="bookmark">Protected: James Shore: Successful Software</a>
		</h1>
		
		<div class="entry-meta">
			<span class="date"><a href="../../../../../index.html@p=331.html" title="Permalink to Protected: James Shore: Successful Software" rel="bookmark"><time class="entry-date" datetime="2008-11-17T09:39:03+00:00">November 17, 2008</time></a></span><span class="categories-links"><a href="../../index.html" rel="category tag">Geek</a></span><span class="tags-links"><a href="../../../../../tag/agile/index.html" rel="tag">agile</a>, <a href="../../../../../tag/process/index.html" rel="tag">process</a>, <a href="../../../../../tag/scrum/index.html" rel="tag">scrum</a></span><span class="author vcard"><a class="url fn n" href="../../../../../author/noocyte/index.html" title="View all posts by noocyte" rel="author">noocyte</a></span>					</div><!-- .entry-meta -->
	</header><!-- .entry-header -->

		<div class="entry-content">
		<form action="http://blog.noocyte.net/wp-login.php?action=postpass" class="post-password-form" method="post">
<p>This content is password protected. To view it please enter your password below:</p>
<p><label for="pwbox-331">Password: <input name="post_password" id="pwbox-331" type="password" size="20" /></label> <input type="submit" name="Submit" value="Submit" /></p>
</form>
	</div><!-- .entry-content -->
	
	<footer class="entry-meta">
					<div class="comments-link">
				Enter your password to view comments.			</div><!-- .comments-link -->
		
			</footer><!-- .entry-meta -->
</article><!-- #post -->
							
<article id="post-326" class="post-326 post type-post status-publish format-standard hentry category-work category-link tag-architecture tag-pubsub tag-synergi">
	<header class="entry-header">
		
				<h1 class="entry-title">
			<a href="../../../../../index.html@p=326.html" rel="bookmark">Mass Transit &#8211; Part 1 of N &#8211; Tim Barcz</a>
		</h1>
		
		<div class="entry-meta">
			<span class="date"><a href="../../../../../index.html@p=326.html" title="Permalink to Mass Transit &#8211; Part 1 of N &#8211; Tim Barcz" rel="bookmark"><time class="entry-date" datetime="2008-10-14T10:57:44+00:00">October 14, 2008</time></a></span><span class="categories-links"><a href="../../index.html" rel="category tag">Geek</a>, <a href="../../../link/index.html" rel="category tag">Link</a></span><span class="tags-links"><a href="../../../../../tag/architecture/index.html" rel="tag">architecture</a>, <a href="../../../../../tag/pubsub/index.html" rel="tag">pub/sub</a>, <a href="../../../../../tag/synergi/index.html" rel="tag">synergi</a></span><span class="author vcard"><a class="url fn n" href="../../../../../author/noocyte/index.html" title="View all posts by noocyte" rel="author">noocyte</a></span>					</div><!-- .entry-meta -->
	</header><!-- .entry-header -->

		<div class="entry-content">
		<p>This looks interesting! I’ll have to follow the next n parts of this! </p>
<blockquote><p>This system started small but gradually had increased demands in the form of new features clients wanted added. Pretty soon, when you clicked the save button multiple things were happening; a database row would be updated, an email would be sent, a new file would be written, another status file would be updated. These were all executed when the user clicked the button, therefore every action was a blocking action, the server couldn&#8217;t move on until it was done servicing that particular request.</p>
</blockquote>
<p><font color="#777777">The quote above is from the blog post and sort of sums up my experience with a CMS-like application (Synergi), where we once did a Save, Send Mail, Commit we ended up with something like this after a few years; Save, Mail, Mail, Mail, Update Table X, Update Table Y, Mail, Commit. So a solution, like the one proposed in the blog post, could work very well for Synergi. Interesting.</font></p>
<p><a href="http://devlicio.us/blogs/tim_barcz/archive/2008/10/13/mass-transit-part-1-of-n.aspx">Mass Transit &#8211; Part 1 of N &#8211; Tim Barcz</a></p>
	</div><!-- .entry-content -->
	
	<footer class="entry-meta">
					<div class="comments-link">
				<a href="../../../../../index.html@p=326.html#respond"><span class="leave-reply">Leave a comment</span></a>			</div><!-- .comments-link -->
		
			</footer><!-- .entry-meta -->
</article><!-- #post -->
			
				<nav class="navigation paging-navigation" role="navigation">
		<h1 class="screen-reader-text">Posts navigation</h1>
		<div class="nav-links">

						<div class="nav-previous"><a href="../3/index.html" ><span class="meta-nav">&larr;</span> Older posts</a></div>
			
						<div class="nav-next"><a href="../../index.html" >Newer posts <span class="meta-nav">&rarr;</span></a></div>
			
		</div><!-- .nav-links -->
	</nav><!-- .navigation -->
	
		
		</div><!-- #content -->
	</div><!-- #primary -->


		</div><!-- #main -->
		<footer id="colophon" class="site-footer" role="contentinfo">
				<div id="secondary" class="sidebar-container" role="complementary">
		<div class="widget-area">
			<aside id="search-2" class="widget widget_search"><form role="search" method="get" class="search-form" action="../../../../../index.html">
				<label>
					<span class="screen-reader-text">Search for:</span>
					<input type="search" class="search-field" placeholder="Search &hellip;" value="" name="s" title="Search for:" />
				</label>
				<input type="submit" class="search-submit" value="Search" />
			</form></aside>		<aside id="recent-posts-2" class="widget widget_recent_entries">		<h3 class="widget-title">Recent Posts</h3>		<ul>
					<li>
				<a href="../../../../../index.html@p=1672.html">Contributing to open source, part II</a>
						</li>
					<li>
				<a href="../../../../../index.html@p=1602.html">Ninject and Factory Injection</a>
						</li>
					<li>
				<a href="../../../../../index.html@p=1562.html">Contributing to open source, part I</a>
						</li>
					<li>
				<a href="../../../../../index.html@p=1342.html">Transient Fault Handling Application Block</a>
						</li>
					<li>
				<a href="../../../../../index.html@p=1252.html">Azure Workers</a>
						</li>
				</ul>
		</aside><aside id="recent-comments-2" class="widget widget_recent_comments"><h3 class="widget-title">Recent Comments</h3><ul id="recentcomments"><li class="recentcomments"><span class="comment-author-link"><a href='../../../../../index.html@p=1672.html' rel='external nofollow' class='url'>Contributing to open source, part II | Home of noocyte</a></span> on <a href="../../../../../index.html@p=1252.html#comment-75">Azure Workers</a></li><li class="recentcomments"><span class="comment-author-link"><a href='../../../../../index.html@p=1672.html' rel='external nofollow' class='url'>Contributing to open source, part II | Home of noocyte</a></span> on <a href="../../../../../index.html@p=1562.html#comment-76">Contributing to open source, part I</a></li><li class="recentcomments"><span class="comment-author-link"><a href='../../../../../2012/11/my-first-adventures-in-git/index.html' rel='external nofollow' class='url'>My first adventures in Git | Home of noocyte</a></span> on <a href="../../../../../index.html@p=167.html#comment-52">Double Key Dictionary</a></li><li class="recentcomments"><span class="comment-author-link"><a href='http://www.kcrunforlife.com/blog/2011/03/08/tune-in-to-see-Brad-Prestons-blog.aspx' rel='external nofollow' class='url'>new android apps</a></span> on <a href="../../../../../index.html@p=167.html#comment-51">Double Key Dictionary</a></li><li class="recentcomments"><span class="comment-author-link"><a href='http://clickherenow' rel='external nofollow' class='url'>Lissa Lloyd</a></span> on <a href="../../../../../index.html@p=167.html#comment-50">Double Key Dictionary</a></li></ul></aside><aside id="archives-2" class="widget widget_archive"><h3 class="widget-title">Archives</h3>		<ul>
	<li><a href='../../../../../2014/03/index.html'>March 2014</a></li>
	<li><a href='../../../../../2014/02/index.html'>February 2014</a></li>
	<li><a href='../../../../../2013/11/index.html'>November 2013</a></li>
	<li><a href='../../../../../2013/01/index.html'>January 2013</a></li>
	<li><a href='../../../../../2012/11/index.html'>November 2012</a></li>
	<li><a href='../../../../../2012/10/index.html'>October 2012</a></li>
	<li><a href='../../../../../2012/09/index.html'>September 2012</a></li>
	<li><a href='../../../../../2012/08/index.html'>August 2012</a></li>
	<li><a href='../../../../../2011/11/index.html'>November 2011</a></li>
	<li><a href='../../../../../2011/10/index.html'>October 2011</a></li>
	<li><a href='../../../../../2011/09/index.html'>September 2011</a></li>
	<li><a href='../../../../../2009/10/index.html'>October 2009</a></li>
	<li><a href='../../../../../2009/08/index.html'>August 2009</a></li>
	<li><a href='../../../../../2008/11/index.html'>November 2008</a></li>
	<li><a href='../../../../../2008/10/index.html'>October 2008</a></li>
	<li><a href='../../../../../2008/09/index.html'>September 2008</a></li>
	<li><a href='../../../../../2008/08/index.html'>August 2008</a></li>
	<li><a href='../../../../../2008/07/index.html'>July 2008</a></li>
	<li><a href='../../../../../2008/06/index.html'>June 2008</a></li>
	<li><a href='../../../../../2008/05/index.html'>May 2008</a></li>
	<li><a href='../../../../../2008/04/index.html'>April 2008</a></li>
	<li><a href='../../../../../2008/03/index.html'>March 2008</a></li>
	<li><a href='../../../../../2008/02/index.html'>February 2008</a></li>
	<li><a href='../../../../../2008/01/index.html'>January 2008</a></li>
	<li><a href='../../../../../2007/12/index.html'>December 2007</a></li>
	<li><a href='../../../../../2007/11/index.html'>November 2007</a></li>
	<li><a href='../../../../../2007/10/index.html'>October 2007</a></li>
		</ul>
</aside><aside id="categories-2" class="widget widget_categories"><h3 class="widget-title">Categories</h3>		<ul>
	<li class="cat-item cat-item-3 current-cat"><a href="../../index.html" >Geek</a>
</li>
	<li class="cat-item cat-item-4"><a href="../../../link/index.html" >Link</a>
</li>
	<li class="cat-item cat-item-6"><a href="../../../personal/index.html" >Personal</a>
</li>
	<li class="cat-item cat-item-7"><a href="../../../../uxrisk/index.html" >uxrisk</a>
</li>
		</ul>
</aside><aside id="meta-2" class="widget widget_meta"><h3 class="widget-title">Meta</h3>			<ul>
						<li><a href="../../../../../wp-login.php.html">Log in</a></li>
			<li><a href="../../../../../feed/index.html">Entries <abbr title="Really Simple Syndication">RSS</abbr></a></li>
			<li><a href="../../../../../comments/feed/index.html">Comments <abbr title="Really Simple Syndication">RSS</abbr></a></li>
<li><a href="https://wordpress.org/" title="Powered by WordPress, state-of-the-art semantic personal publishing platform.">WordPress.org</a></li>			</ul>
</aside>		</div><!-- .widget-area -->
	</div><!-- #secondary -->

			<div class="site-info">
								<a href="http://wordpress.org/" title="Semantic Personal Publishing Platform">Proudly powered by WordPress</a>
			</div><!-- .site-info -->
		</footer><!-- #colophon -->
	</div><!-- #page -->

	<script type='text/javascript' src='../../../../../wp-includes/js/masonry.min.js@ver=3.1.2'></script>
<script type='text/javascript' src='../../../../../wp-includes/js/jquery/jquery.masonry.min.js@ver=3.1.2'></script>
<script type='text/javascript' src='../../../../../wp-content/themes/twentythirteen/js/functions.js@ver=2014-06-08'></script>
</body>
</html>